<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Parameter fitting for multivariate Huesler--Reiss Pareto distributions on block graphs — fmpareto_graph_HR • graphicalExtremes</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Parameter fitting for multivariate Huesler--Reiss Pareto distributions on block graphs — fmpareto_graph_HR" />
<meta property="og:description" content="Fits the parameters of a multivariate Huesler--Reiss Pareto distribution using (censored) likelihood estimation.
Fitting is done separately on the cliques of the block graph. If  edges_to_add
are provided, then these edges are added in a greedy search to the original graph,
such that in each step the likelihood is improved maximally and the new graph stays in the
class of block graphs. See Engelke and Hitz (2020)
 for details." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">graphicalExtremes</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/graphicalExtremes.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Parameter fitting for multivariate Huesler--Reiss Pareto distributions on block graphs</h1>
    
    <div class="hidden name"><code>fmpareto_graph_HR.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Fits the parameters of a multivariate Huesler--Reiss Pareto distribution using (censored) likelihood estimation.
Fitting is done separately on the cliques of the block graph. If  <code>edges_to_add</code>
are provided, then these edges are added in a greedy search to the original <code>graph</code>,
such that in each step the likelihood is improved maximally and the new graph stays in the
class of block graphs. See Engelke and Hitz (2020)
 for details.</p>
    </div>

    <pre class="usage"><span class='fu'>fmpareto_graph_HR</span><span class='op'>(</span><span class='va'>data</span>, <span class='va'>graph</span>, p <span class='op'>=</span> <span class='cn'>NULL</span>, cens <span class='op'>=</span> <span class='cn'>FALSE</span>, edges_to_add <span class='op'>=</span> <span class='cn'>NULL</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>data</th>
      <td><p>Numeric matrix of size \(n\times d\), where \(n\) is the
number of observations and \(d\) is the dimension.</p></td>
    </tr>
    <tr>
      <th>graph</th>
      <td><p>Graph object from <code>igraph</code> package. The <code>graph</code> must be an undirected block graph, i.e., a decomposable, connected
graph with singleton separator sets.</p></td>
    </tr>
    <tr>
      <th>p</th>
      <td><p>Numeric between 0 and 1 or <code>NULL</code>. If <code>NULL</code> (default),
it is assumed that the <code>data</code> are already on multivariate Pareto scale. Else,
<code>p</code> is used as the probability in the function <code><a href='data2mpareto.html'>data2mpareto</a></code>
to standardize the <code>data</code>.</p></td>
    </tr>
    <tr>
      <th>cens</th>
      <td><p>Logical. If true, then censored likelihood contributions are used for
components below the threshold. By default, <code>cens = FALSE</code>.</p></td>
    </tr>
    <tr>
      <th>edges_to_add</th>
      <td><p>Numeric matrix \(m\times 2\), where \(m\) is
the number of edges that are tried to be added in the greedy search.
By default, <code>edges_to_add = NULL</code>.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>List consisting of:</p><ul>
<li><p><code>graph</code>: Graph object from <code>igraph</code> package. If <code>edges_to_add</code> are provided,
then this is a list of the resulting graphs in each step of the greedy search.</p></li>
<li><p><code>Gamma</code>: Numeric \(d\times d\) estimated variogram matrix \(\Gamma\).
If <code>edges_to_add</code> are provided,
then this is a list of the estimated variogram matrices in each step of the greedy search.</p></li>
<li><p><code>AIC</code>: (only if <code>edges_to_add</code> are provided) List of AIC values of the fitted models
in each step of the greedy search.</p></li>
<li><p><code>edges_added</code>: (only if <code>edges_to_add</code> are provided) Numeric matrix \(m'\times 2\), where
the \(m'\leq m\) rows contain the edges that were added in the greedy search.</p></li>
</ul>

    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Engelke S, Hitz AS (2020).
&#8220;Graphical models for extremes (with discussion).&#8221;
<em>J. R. Stat. Soc. Ser. B Stat. Methodol.</em>, <b>82</b>, 871--932.</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'>## Fitting a 4-dimensional HR distribution</span>

<span class='va'>my_graph</span> <span class='op'>&lt;-</span> <span class='fu'>igraph</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/igraph/man/graph_from_adjacency_matrix.html'>graph_from_adjacency_matrix</a></span><span class='op'>(</span>
  <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>rbind</a></span><span class='op'>(</span>
    <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>1</span>, <span class='fl'>0</span>, <span class='fl'>0</span><span class='op'>)</span>,
    <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>0</span>, <span class='fl'>1</span>, <span class='fl'>1</span><span class='op'>)</span>,
    <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>1</span>, <span class='fl'>0</span>, <span class='fl'>0</span><span class='op'>)</span>,
    <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>1</span>, <span class='fl'>0</span>, <span class='fl'>0</span><span class='op'>)</span>
  <span class='op'>)</span>,
  mode <span class='op'>=</span> <span class='st'>"undirected"</span>
<span class='op'>)</span>
<span class='va'>n</span> <span class='op'>&lt;-</span> <span class='fl'>100</span>
<span class='va'>Gamma_vec</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>.5</span>, <span class='fl'>1.4</span>, <span class='fl'>.8</span><span class='op'>)</span>
<span class='fu'><a href='complete_Gamma.html'>complete_Gamma</a></span><span class='op'>(</span>Gamma <span class='op'>=</span> <span class='va'>Gamma_vec</span>, graph <span class='op'>=</span> <span class='va'>my_graph</span><span class='op'>)</span> <span class='co'>## full Gamma matrix</span>
</div><div class='output co'>#&gt;      [,1] [,2] [,3] [,4]
#&gt; [1,]  0.0  0.5  1.9  1.3
#&gt; [2,]  0.5  0.0  1.4  0.8
#&gt; [3,]  1.9  1.4  0.0  2.2
#&gt; [4,]  1.3  0.8  2.2  0.0</div><div class='input'><span class='va'>edges_to_add</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>rbind</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>3</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>4</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>3</span>, <span class='fl'>4</span><span class='op'>)</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>123</span><span class='op'>)</span>
<span class='va'>my_data</span> <span class='op'>&lt;-</span> <span class='fu'><a href='rmpareto_tree.html'>rmpareto_tree</a></span><span class='op'>(</span><span class='va'>n</span>, <span class='st'>"HR"</span>, tree <span class='op'>=</span> <span class='va'>my_graph</span>, par <span class='op'>=</span> <span class='va'>Gamma_vec</span><span class='op'>)</span>
<span class='va'>my_fit</span> <span class='op'>&lt;-</span> <span class='fu'>fmpareto_graph_HR</span><span class='op'>(</span><span class='va'>my_data</span>,
  graph <span class='op'>=</span> <span class='va'>my_graph</span>,
  p <span class='op'>=</span> <span class='cn'>NULL</span>, cens <span class='op'>=</span> <span class='cn'>FALSE</span>, edges_to_add <span class='op'>=</span> <span class='va'>edges_to_add</span>
<span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='error'>Error in stats::optim(init_opt, nllik, hessian = TRUE, control = list(maxit = maxit),     method = method): non-finite value supplied by optim</span></div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Sebastian Engelke, Adrien S. Hitz, Nicola Gnecco.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


